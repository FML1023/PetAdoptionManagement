@page "/"
@rendermode InteractiveServer
@inject IJSRuntime JS // ✅ Inject JavaScript Runtime to force UI refresh
@inject AuthenticationStateProvider AuthProvider
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject SignInManager<PetAdoptionManagementUser> SignInManager
@using Microsoft.EntityFrameworkCore
@using PetAdoptionManagement.Data
@using PetAdoptionManagement.Components.Domain
@using Microsoft.AspNetCore.Identity

@code {
    private string? username;
    private bool isAuthenticated;

    protected override async Task OnInitializedAsync()
    {
        StateHasChanged();
        // Get the current user
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        // Check if the user is authenticated and retrieve the username
        isAuthenticated = user.Identity?.IsAuthenticated ?? false;
        username = isAuthenticated ? user.Identity.Name : null;
    }

}

<div class="container-fluid p-0" style="font-family: 'Poppins', sans-serif; background: #FFD194; overflow-x: hidden;">
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light" style="background: linear-gradient(to right, #FFD194, #D1913C);">
        <div class="container">
            <a class="navbar-brand" href="/">🐾 Paws & Claws</a>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="/pets">Pets</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/contact">Contact</a></li>
                  
                    <AuthorizeView Roles="Administrator">
                        <li class="nav-item"><a class="nav-link" href="/admin/petApprovals">Admin Panel</a></li>
                    </AuthorizeView>

                    <!-- Show logout button if authenticated -->
                    @if (isAuthenticated)
                    {
                        <li class="nav-item"><span class="nav-link">Welcome, @username</span></li>
                        <li class="nav-item"><a class="nav-link" href="/users/details">Profile</a></li>
                        <li class="nav-item"><a class="nav-link" href="/Account/Logout">Logout</a></li>


                    }
                    else
                    {
                        <li class="nav-item"><a class="nav-link" href="/Account/Login">Login</a></li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="row align-items-center justify-content-center m-0" style="min-height: 90vh; background: #fff8e1; overflow-x: hidden;">
        <div class="col-md-6 p-5 text-center text-md-start">
            <h1 class="display-4 fw-bold" style="color: #fb928b;">One More Friend</h1>
            <h2 class="mb-4" style="color: #fb928b;">Thousands More Fun!</h2>
            <p class="text-muted lead">
                Having a pet means you have more joy, a new friend, a happy person who will always be with you to have fun.
                We have 200+ different pets that can meet your needs!
            </p>
            <div class="mt-4">
                <a class="btn btn-primary px-4 py-2" href="/pets" style="border-radius: 25px;">View Pets</a>
            </div>
        </div>
        <div class="col-md-6 text-center">
            <img src="catlady.jpg" alt="Cat and Owner" class="img-fluid" style="max-height: 500px;" />
        </div>
    </div>

    <!-- Pet Showcase Section -->
    <div class="container mt-5" style="overflow-x: hidden;">
        <!-- Section Title -->
        <h2 class="text-center mb-4" style="color: #333;">Take A Look At Some Of Our Pets</h2>

        <!-- Pet Cards -->
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4">
            <!-- Pet 1 -->
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="orangecat.jpg" class="card-img-top" alt="Orange Cat" />
                    <div class="card-body">
                        <h5 class="card-title">MO231 - Orange Cat</h5>
                        <p class="card-text">
                            <strong>Gene:</strong> Male<br />
                            <strong>Age:</strong> 3 years old
                        </p>
                    </div>
                    <div class="card-footer bg-white">
                        <strong>S$10,000</strong>
                    </div>
                </div>
            </div>

            <!-- Pet 2 -->
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="whitepomeranian.jpg" class="card-img-top" alt="White Pomeranian" />
                    <div class="card-body">
                        <h5 class="card-title">MO502 - White Pomeranian</h5>
                        <p class="card-text">
                            <strong>Gene:</strong> Female<br />
                            <strong>Age:</strong> 2 months
                        </p>
                    </div>
                    <div class="card-footer bg-white">
                        <strong>S$8,000</strong>
                    </div>
                </div>
            </div>

            <!-- Pet 3 -->
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="bunnysideeye.jpg" class="card-img-top" alt="Bunny" />
                    <div class="card-body">
                        <h5 class="card-title">MO102 - Orange Bunny</h5>
                        <p class="card-text">
                            <strong>Gene:</strong> Male<br />
                            <strong>Age:</strong> 2 months
                        </p>
                    </div>
                    <div class="card-footer bg-white">
                        <strong>S$500</strong>
                    </div>
                </div>
            </div>

            <!-- Pet 4 -->
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="bird.jpg" class="card-img-top" alt="bird" />
                    <div class="card-body">
                        <h5 class="card-title">MO512 - Bird</h5>
                        <p class="card-text">
                            <strong>Gene:</strong> Male<br />
                            <strong>Age:</strong> 2 months
                        </p>
                    </div>
                    <div class="card-footer bg-white">
                        <strong>S$200</strong>
                    </div>
                </div>
            </div>
        </div>

        <!-- View More Button -->
        <div class="text-center mt-4">
            <a href="/pets" class="btn btn-outline-primary">View more</a>
        </div>
    </div>
</div>
